(()=>{"use strict";const t=document.querySelector("#board-1"),s=document.querySelector("#board-2"),e=async e=>{0===e?(t.classList.remove("active"),s.classList.add("active")):1===e&&(s.classList.remove("active"),t.classList.add("active"))},a=(e,a,r)=>{r||(t.classList.add("active"),s.classList.add("active")),t.innerHTML="",s.innerHTML="",[{board:e,element:t},{board:a,element:s}].forEach((({board:t,element:s})=>{const a=[];for(let s=0;s<t[0].length;s++){const e=[];for(let a=0;a<t.length;a++)e.push(t[a][s]);a.push(e)}a.forEach(((a,r)=>{const i=document.createElement("div");i.classList.add("board-column"),s.appendChild(i),a.forEach(((s,a)=>{const o=document.createElement("div");o.classList.add("grid"),o.dataset.y=`${r}`,o.dataset.x=`${a}`,i.appendChild(o),Number.isInteger(s)||t!=e||o.classList.add("ship"),1==s&&o.classList.add("missed"),s[1]&&"x"===s[1].hitMarker&&(o.classList.add("hit"),!0===s[0].status&&o.classList.add("sunk"))}))}))})),console.log(e,a)};class r{constructor(t,s){this.id=t,this.length=s,this.hits=0,this.status=!1}hit(){this.hits+=1}isSunk(){let t=this.hits>=this.length;return!0===t&&(this.status=!0),t}}class i{constructor(){this.board=Array(10).fill(0).map((()=>Array(10).fill(0))),this.ships=[]}isCellEmpty(t,s){return 0===this.board[t][s]}placeShip(t,s,e,a){if("vertical"===a){if(t+e>this.board.length)return!1}else if("horizontal"===a&&s+e>this.board[0].length)return!1;for(let r=0;r<e;r++)if("vertical"===a){if(!this.isCellEmpty(t+r,s))return!1}else if("horizontal"===a&&!this.isCellEmpty(t,s+r))return!1;const i=new r(`ship_${t}_${s}`,e);for(let r=0;r<e;r++)"vertical"===a?this.board[t+r][s]=i:this.board[t][s+r]=i;return this.ships.push(i),this.board}placeShipRandomly(){const t=[5,4,3,3,2];for(let s=0;s<t.length;s++){let e=!1;for(;!e;){let a=Math.floor(10*Math.random()),r=Math.floor(10*Math.random()),i=Math.random()<.5?"vertical":"horizontal";e=this.placeShip(a,r,t[s],i)}}return this.board}recieveAttack(t,s){const e=this.board[t][s];return e instanceof r?(e.hit(),this.board[t][s]=[{...this.board[t][s]},{hitMarker:"x"}],e.isSunk(),!0):(this.board[t][s]=1,!1)}areAllSunk(){return this.ships.every((t=>t.isSunk()))}updateBoardsShips(){let t=this.ships.filter((t=>!0===t.status));if(!t.length)return!1;this.board.forEach((s=>{s.forEach((s=>{t.some((t=>s[0]&&s[0].id===t.id))&&(s[0].status=!0)}))}))}}class o{constructor(t){this.name=t}attackShip(t,s,e){return e.recieveAttack(t,s),e.board}attackRandomly(t){let s=Math.floor(10*Math.random()),e=Math.floor(10*Math.random());return t.recieveAttack(s,e),t.board}}(()=>{const t=new o("Player"),s=new o("Computer"),r=new i,l=new i;let n=!1,d=!1;l.placeShipRandomly(),r.placeShipRandomly(),a(r.board,l.board,n),document.addEventListener("click",(i=>{if(i.target.closest(".start-btn"))return n=!0,void e(0);if(i.target.closest(".grid")&&n){if("board-2"!==i.target.closest(".board").id)return;(async i=>{const{xCoord:o,yCoord:c}=(t=>{let s,e,a=0;for(const r in t)0===a?(e=t[r],a++):1===a&&(s=t[r],a++);return{xCoord:s,yCoord:e}})(i);t.attackShip(o,c,l),l.updateBoardsShips(),e(1),l.areAllSunk()&&(console.log("Player Wins!"),d=!0),a(r.board,l.board,n),await new Promise((t=>setTimeout(t,800))),s.attackRandomly(r),r.updateBoardsShips(),e(0),r.areAllSunk()&&(console.log("Computer Wins!"),d=!0),a(r.board,l.board,n)})(i.target.dataset)}}))})()})();