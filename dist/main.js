(()=>{"use strict";const t=document.querySelector("#board-1"),s=document.querySelector("#board-2"),e=async e=>{0===e?(t.classList.remove("active"),s.classList.add("active")):1===e&&(s.classList.remove("active"),t.classList.add("active"))},r=(e,r,a)=>{a||(t.classList.add("active"),s.classList.add("active")),t.innerHTML="",s.innerHTML="",[{board:e,element:t},{board:r,element:s}].forEach((({board:t,element:s})=>{const r=[];for(let s=0;s<t[0].length;s++){const e=[];for(let r=0;r<t.length;r++)e.push(t[r][s]);r.push(e)}r.forEach(((r,a)=>{const i=document.createElement("div");i.classList.add("board-column"),s.appendChild(i),r.forEach(((s,r)=>{const o=document.createElement("div");o.classList.add("grid"),o.dataset.y=`${a}`,o.dataset.x=`${r}`,i.appendChild(o),Number.isInteger(s)||t!=e||o.classList.add("ship"),1==s&&o.classList.add("missed"),s[1]&&"x"===s[1].hitMarker&&(o.classList.add("hit"),!0===s[0].status&&o.classList.add("sunk"))}))}))})),console.log(e,r)};class a{constructor(t,s){this.id=t,this.length=s,this.hits=0,this.status=!1}hit(){this.hits+=1}isSunk(){let t=this.hits>=this.length;return!0===t&&(this.status=!0),t}getLength(){return this.length}}class i{constructor(){this.board=Array(10).fill(0).map((()=>Array(10).fill(0))),this.ships=[]}isCellEmpty(t,s){return 0===this.board[t][s]}placeShip(t,s,e,r){if("vertical"===r){if(t+e>this.board.length)return!1}else if("horizontal"===r&&s+e>this.board[0].length)return!1;for(let a=0;a<e;a++)if("vertical"===r){if(!this.isCellEmpty(t+a,s))return!1}else if("horizontal"===r&&!this.isCellEmpty(t,s+a))return!1;const i=new a(`ship_${t}_${s}`,e);for(let a=0;a<e;a++)"vertical"===r?this.board[t+a][s]=i:this.board[t][s+a]=i;return this.ships.push(i),this.board}placeShipRandomly(){const t=[5,4,3,3,2];for(let s=0;s<t.length;s++){let e=!1;for(;!e;){let r=Math.floor(10*Math.random()),a=Math.floor(10*Math.random()),i=Math.random()<.5?"vertical":"horizontal";e=this.placeShip(r,a,t[s],i)}}return this.board}recieveAttack(t,s){const e=this.board[t][s];return e instanceof a?(e.hit(),this.board[t][s]=[{...this.board[t][s]},{hitMarker:"x"}],e.isSunk(),!0):(this.board[t][s]=1,!1)}areAllSunk(){return this.ships.every((t=>t.isSunk()))}updateBoardsShips(){let t=this.ships.filter((t=>!0===t.status));if(!t.length)return!1;this.board.forEach((s=>{s.forEach((s=>{t.some((t=>s[0]&&s[0].id===t.id))&&(s[0].status=!0)}))}))}findShip(t,s){return this.ships.find((e=>e.id===this.board[t][s].id))}removeShip(t,s){const e=this.findShip(t,s),r=this.ships.indexOf(e);return-1!==r&&this.ships.splice(r,1),this.board.forEach((t=>{t.forEach(((s,r)=>{s===e&&(t[r]=0)}))})),this.board}}class o{constructor(t){this.name=t}attackShip(t,s,e){return e.recieveAttack(t,s),e.board}attackRandomly(t){let s=Math.floor(10*Math.random()),e=Math.floor(10*Math.random());return t.recieveAttack(s,e),t.board}}(()=>{const t=new o("Player"),s=new o("Computer"),a=new i,n=new i;let d=!1,h=!1;n.placeShipRandomly(),a.placeShipRandomly(),r(a.board,n.board,d),document.addEventListener("click",(i=>{if(i.target.closest(".start-btn"))return d=!0,void e(0);if(i.target.closest(".grid")&&d){if("board-2"!==i.target.closest(".board").id)return;(async i=>{const{xCoord:o,yCoord:l}=(t=>{let s,e,r=0;for(const a in t)0===r?(e=t[a],r++):1===r&&(s=t[a],r++);return{xCoord:s,yCoord:e}})(i);t.attackShip(o,l,n),n.updateBoardsShips(),e(1),n.areAllSunk()&&(console.log("Player Wins!"),h=!0),r(a.board,n.board,d),await new Promise((t=>setTimeout(t,800))),s.attackRandomly(a),a.updateBoardsShips(),e(0),a.areAllSunk()&&(console.log("Computer Wins!"),h=!0),r(a.board,n.board,d)})(i.target.dataset)}}))})()})();